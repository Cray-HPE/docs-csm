<!DOCTYPE html>
<html lang="en-09" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.123.0">
    <meta name="description" content="">


    <link rel="icon" href="/docs-csm/images/favicon.png" type="image/png">

    <title>Setup Site-Init From SHASTA-CFG :: Cray System Management (CSM)</title>

    
    <link href="/docs-csm/css/nucleus.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/fontawesome-all.min.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/hybrid.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/featherlight.min.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/perfect-scrollbar.min.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/auto-complete.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/atom-one-dark-reasonable.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/theme.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/tabs.css?1729741357" rel="stylesheet">
    <link href="/docs-csm/css/hugo-theme.css?1729741357" rel="stylesheet">
    
    <link href="/docs-csm/css/theme-blue.css?1729741357" rel="stylesheet">
    
    

    <script src="/docs-csm/js/jquery-3.3.1.min.js?1729741357"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs-csm/en-09/067-shasta-cfg/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/docs-csm/en-09'>
  Cray System Management
</a>

    </div>

    
    <section>
      <ul>
      
        <li>
          <div class="select-style padding">
          v <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
                    
                    
                      <option id="en-09" value="/docs-csm/en-09/067-shasta-cfg/" selected>0.9</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </li>
      

      
      </ul>
    </section>
  

    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/docs-csm/js/lunr.min.js?1729741357"></script>
<script type="text/javascript" src="/docs-csm/js/auto-complete.js?1729741357"></script>
<script type="text/javascript">
    
        var baseurl = "\/docs-csm\/\/en-09";
    
</script>
<script type="text/javascript" src="/docs-csm/js/search.js?1729741357"></script>

    
  </div>

  

    <div class="highlightable">
    <ul class="topics">
      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/421-mgmt-net-cabling-checklist/" title="1.4 Management network cabling checklist" class="dd-item ">
        <a href="/docs-csm/en-09/421-mgmt-net-cabling-checklist/">
        1.4 Management network cabling checklist
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/308-application-node-config/" title="Application Node Config" class="dd-item ">
        <a href="/docs-csm/en-09/308-application-node-config/">
        Application Node Config
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/310-cabinets/" title="Cabinets" class="dd-item ">
        <a href="/docs-csm/en-09/310-cabinets/">
        Cabinets
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/416-mgmt-net-cabling/" title="Cabling" class="dd-item ">
        <a href="/docs-csm/en-09/416-mgmt-net-cabling/">
        Cabling
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/066-ceph-csi/" title="CEPH CSI Verification" class="dd-item ">
        <a href="/docs-csm/en-09/066-ceph-csi/">
        CEPH CSI Verification
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/302-ncn-metadata-bondx/" title="Collecting NCN MAC Addresses" class="dd-item ">
        <a href="/docs-csm/en-09/302-ncn-metadata-bondx/">
        Collecting NCN MAC Addresses
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/301-ncn-metadata-bmc/" title="Collecting the BMC MAC Addresses" class="dd-item ">
        <a href="/docs-csm/en-09/301-ncn-metadata-bmc/">
        Collecting the BMC MAC Addresses
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/257-firmware-action-service-cray-windom-compute-node-bios-workaround/" title="Compute Node BIOS workaround for WNC-rome aka HPE CRAY EX425" class="dd-item ">
        <a href="/docs-csm/en-09/257-firmware-action-service-cray-windom-compute-node-bios-workaround/">
        Compute Node BIOS workaround for WNC-rome aka HPE CRAY EX425
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/000-info/" title="CRAY Guide Contribution" class="dd-item ">
        <a href="/docs-csm/en-09/000-info/">
        CRAY Guide Contribution
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/063-csi-files/" title="Cray Site Init Files" class="dd-item ">
        <a href="/docs-csm/en-09/063-csi-files/">
        Cray Site Init Files
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/release_notes/" title="Cray System Management (CSM) - Release Notes" class="dd-item ">
        <a href="/docs-csm/en-09/release_notes/">
        Cray System Management (CSM) - Release Notes
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/001-guides/" title="CSM Documentation Guide" class="dd-item ">
        <a href="/docs-csm/en-09/001-guides/">
        CSM Documentation Guide
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/002-csm-install/" title="CSM Install" class="dd-item ">
        <a href="/docs-csm/en-09/002-csm-install/">
        CSM Install
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/007-csm-install-reboot/" title="CSM Install Reboot - Final NCN Install" class="dd-item ">
        <a href="/docs-csm/en-09/007-csm-install-reboot/">
        CSM Install Reboot - Final NCN Install
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/008-csm-validation/" title="CSM Install Validation and Health Checks" class="dd-item ">
        <a href="/docs-csm/en-09/008-csm-validation/">
        CSM Install Validation and Health Checks
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/005-csm-metal-install/" title="CSM Metal Install" class="dd-item ">
        <a href="/docs-csm/en-09/005-csm-metal-install/">
        CSM Metal Install
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/006-csm-platform-install/" title="CSM Platform Install" class="dd-item ">
        <a href="/docs-csm/en-09/006-csm-platform-install/">
        CSM Platform Install
        
        </a>
    </li>
     
  
 

      
      




 
  
    
    <li data-nav-id="/docs-csm/en-09/troubleshooting/" title="CSM Troubleshooting Information" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/troubleshooting/">
          CSM Troubleshooting Information
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/troubleshooting/known_issues/" title="known issues" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/troubleshooting/known_issues/">
          known issues
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/troubleshooting/known_issues/cfs_sessions_stuck_in_pending/" title="CFS Sessions are Stuck in Pending State" class="dd-item ">
        <a href="/docs-csm/en-09/troubleshooting/known_issues/cfs_sessions_stuck_in_pending/">
        CFS Sessions are Stuck in Pending State
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/troubleshooting/known_issues/conman_pod_kubernetes_copy_fails/" title="Copying file from the cray-conman pod fails" class="dd-item ">
        <a href="/docs-csm/en-09/troubleshooting/known_issues/conman_pod_kubernetes_copy_fails/">
        Copying file from the cray-conman pod fails
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/troubleshooting/known_issues/orphaned_cfs_pods/" title="Orphaned CFS Pods After Booting or Rebooting" class="dd-item ">
        <a href="/docs-csm/en-09/troubleshooting/known_issues/orphaned_cfs_pods/">
        Orphaned CFS Pods After Booting or Rebooting
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/003-csm-usb-livecd/" title="CSM USB LiveCD - Creation and Configuration" class="dd-item ">
        <a href="/docs-csm/en-09/003-csm-usb-livecd/">
        CSM USB LiveCD - Creation and Configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/051-disk-cleanslate/" title="Disk Cleanslate" class="dd-item ">
        <a href="/docs-csm/en-09/051-disk-cleanslate/">
        Disk Cleanslate
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/255-firmware-action-service-fas/" title="FIRMWARE ACTION SERVICE (FAS) | User Procedures" class="dd-item ">
        <a href="/docs-csm/en-09/255-firmware-action-service-fas/">
        FIRMWARE ACTION SERVICE (FAS) | User Procedures
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/256-firmware-action-service-fas-recipes/" title="Firmware Action Service (FAS) Administration Guide" class="dd-item ">
        <a href="/docs-csm/en-09/256-firmware-action-service-fas-recipes/">
        Firmware Action Service (FAS) Administration Guide
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/250-firmware/" title="Firmware Checkout" class="dd-item ">
        <a href="/docs-csm/en-09/250-firmware/">
        Firmware Checkout
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/010-firmware-update-with-fas/" title="Firmware Update the system with FAS" class="dd-item ">
        <a href="/docs-csm/en-09/010-firmware-update-with-fas/">
        Firmware Update the system with FAS
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/254-ncn-firmware-gb/" title="Gigabyte Firmware Bug" class="dd-item ">
        <a href="/docs-csm/en-09/254-ncn-firmware-gb/">
        Gigabyte Firmware Bug
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/304-ncn-pcie-net-boot-and-re-cable/" title="Guide  Netboot an NCN from a Spine" class="dd-item ">
        <a href="/docs-csm/en-09/304-ncn-pcie-net-boot-and-re-cable/">
        Guide  Netboot an NCN from a Spine
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/068-harvest-13-config/" title="HARVEST 13 CONFIG" class="dd-item ">
        <a href="/docs-csm/en-09/068-harvest-13-config/">
        HARVEST 13 CONFIG
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/307-hmn-connections/" title="HMN Connections File" class="dd-item ">
        <a href="/docs-csm/en-09/307-hmn-connections/">
        HMN Connections File
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/418-mgmt-net-ip-helper/" title="IP-Helper configuration" class="dd-item ">
        <a href="/docs-csm/en-09/418-mgmt-net-ip-helper/">
        IP-Helper configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/061-livecd-metal-basecamp/" title="LiveCD - Metal Basecamp" class="dd-item ">
        <a href="/docs-csm/en-09/061-livecd-metal-basecamp/">
        LiveCD - Metal Basecamp
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/060-livecd-1.3-rollback/" title="LiveCD 1.3 Rollback" class="dd-item ">
        <a href="/docs-csm/en-09/060-livecd-1.3-rollback/">
        LiveCD 1.3 Rollback
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/059-livecd-backup/" title="LiveCD Re-Installs" class="dd-item ">
        <a href="/docs-csm/en-09/059-livecd-backup/">
        LiveCD Re-Installs
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/058-livecd-troubleshooting/" title="LiveCD Recovery" class="dd-item ">
        <a href="/docs-csm/en-09/058-livecd-troubleshooting/">
        LiveCD Recovery
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/004-csm-remote-livecd/" title="LiveCD Remote ISO Install" class="dd-item ">
        <a href="/docs-csm/en-09/004-csm-remote-livecd/">
        LiveCD Remote ISO Install
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/062-livecd-virtual-iso-boot/" title="LiveCD Virtual ISO Boot" class="dd-item ">
        <a href="/docs-csm/en-09/062-livecd-virtual-iso-boot/">
        LiveCD Virtual ISO Boot
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/405-mgmt-net-port-config/" title="Management Network Access Port configurations." class="dd-item ">
        <a href="/docs-csm/en-09/405-mgmt-net-port-config/">
        Management Network Access Port configurations.
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/406-mgmt-net-acl-config/" title="Management Network ACL configuration" class="dd-item ">
        <a href="/docs-csm/en-09/406-mgmt-net-acl-config/">
        Management Network ACL configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/402-mgmt-net-base-config/" title="Management Network Base Configuration" class="dd-item ">
        <a href="/docs-csm/en-09/402-mgmt-net-base-config/">
        Management Network Base Configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/408-mgmt-net-can-config/" title="Management Network CAN setup" class="dd-item ">
        <a href="/docs-csm/en-09/408-mgmt-net-can-config/">
        Management Network CAN setup
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/412-mgmt-net-dell-mellanox-upgrades/" title="Management Network Dell And Mellanox Upgrades" class="dd-item ">
        <a href="/docs-csm/en-09/412-mgmt-net-dell-mellanox-upgrades/">
        Management Network Dell And Mellanox Upgrades
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/413-mgmt-net-example-config/" title="Management Network Example Config" class="dd-item ">
        <a href="/docs-csm/en-09/413-mgmt-net-example-config/">
        Management Network Example Config
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/409-mgmt-net-firmware-update/" title="Management Network Firmware Update" class="dd-item ">
        <a href="/docs-csm/en-09/409-mgmt-net-firmware-update/">
        Management Network Firmware Update
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/417-mgmt-net-flow-control/" title="Management Network Flow Control Settings" class="dd-item ">
        <a href="/docs-csm/en-09/417-mgmt-net-flow-control/">
        Management Network Flow Control Settings
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/411-mgmt-net-layer3-config/" title="Management Network Layer3 Configuration" class="dd-item ">
        <a href="/docs-csm/en-09/411-mgmt-net-layer3-config/">
        Management Network Layer3 Configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/404-mgmt-net-mlag-config/" title="Management Network MLAG Configuration" class="dd-item ">
        <a href="/docs-csm/en-09/404-mgmt-net-mlag-config/">
        Management Network MLAG Configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/414-mgmt-net-ntp-config/" title="Management Network NTP configuration" class="dd-item ">
        <a href="/docs-csm/en-09/414-mgmt-net-ntp-config/">
        Management Network NTP configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/407-mgmt-net-snmp-config/" title="Management Network SNMP configuration" class="dd-item ">
        <a href="/docs-csm/en-09/407-mgmt-net-snmp-config/">
        Management Network SNMP configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/419-mgmt-net-stp/" title="Management Network Spanning-Tree Configuration." class="dd-item ">
        <a href="/docs-csm/en-09/419-mgmt-net-stp/">
        Management Network Spanning-Tree Configuration.
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/415-mgmt-net-switch-rename/" title="Management Network Switch Rename" class="dd-item ">
        <a href="/docs-csm/en-09/415-mgmt-net-switch-rename/">
        Management Network Switch Rename
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/410-mgmt-net-uplink-config/" title="Management Network Uplink configuration" class="dd-item ">
        <a href="/docs-csm/en-09/410-mgmt-net-uplink-config/">
        Management Network Uplink configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/403-mgmt-net-vlan-config/" title="Management Network VLAN Configuration" class="dd-item ">
        <a href="/docs-csm/en-09/403-mgmt-net-vlan-config/">
        Management Network VLAN Configuration
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/306-sls-add-uan-alias/" title="Manually add UAN Aliases to SLS" class="dd-item ">
        <a href="/docs-csm/en-09/306-sls-add-uan-alias/">
        Manually add UAN Aliases to SLS
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/309-move-site-connections/" title="Move Site Connections" class="dd-item ">
        <a href="/docs-csm/en-09/309-move-site-connections/">
        Move Site Connections
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/200-ncn-bios-pref/" title="NCN BIOS Preferences" class="dd-item ">
        <a href="/docs-csm/en-09/200-ncn-bios-pref/">
        NCN BIOS Preferences
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/101-ncn-booting/" title="NCN Booting" class="dd-item ">
        <a href="/docs-csm/en-09/101-ncn-booting/">
        NCN Booting
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/107-ncn-devel/" title="NCN Development" class="dd-item ">
        <a href="/docs-csm/en-09/107-ncn-devel/">
        NCN Development
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/253-ncn-hw-swap/" title="NCN Hardware Swaps" class="dd-item ">
        <a href="/docs-csm/en-09/253-ncn-hw-swap/">
        NCN Hardware Swaps
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/110-ncn-image-customization/" title="NCN Image Customization" class="dd-item ">
        <a href="/docs-csm/en-09/110-ncn-image-customization/">
        NCN Image Customization
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/303-ncn-metadata-usb-serial/" title="NCN Metadata over USB-Serial Cable" class="dd-item ">
        <a href="/docs-csm/en-09/303-ncn-metadata-usb-serial/">
        NCN Metadata over USB-Serial Cable
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/106-ncn-sles/" title="NCN Operating System Release" class="dd-item ">
        <a href="/docs-csm/en-09/106-ncn-sles/">
        NCN Operating System Release
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/105-ncn-packages/" title="NCN Packages" class="dd-item ">
        <a href="/docs-csm/en-09/105-ncn-packages/">
        NCN Packages
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/104-ncn-partitioning/" title="NCN Partitions" class="dd-item ">
        <a href="/docs-csm/en-09/104-ncn-partitioning/">
        NCN Partitions
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/009-ncn-locking/" title="NCN/Management Node Locking" class="dd-item ">
        <a href="/docs-csm/en-09/009-ncn-locking/">
        NCN/Management Node Locking
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/251-firmware-network/" title="Network Firmware" class="dd-item ">
        <a href="/docs-csm/en-09/251-firmware-network/">
        Network Firmware
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/052-network-stack/" title="Network Stack (Software and Hardware)" class="dd-item ">
        <a href="/docs-csm/en-09/052-network-stack/">
        Network Stack (Software and Hardware)
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/103-ncn-networking/" title="Networking" class="dd-item ">
        <a href="/docs-csm/en-09/103-ncn-networking/">
        Networking
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/252-firmware-ncn/" title="Node Firmware" class="dd-item ">
        <a href="/docs-csm/en-09/252-firmware-ncn/">
        Node Firmware
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/100-ncn-images/" title="Non-Compute Node Images" class="dd-item ">
        <a href="/docs-csm/en-09/100-ncn-images/">
        Non-Compute Node Images
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/108-ncn-ntp/" title="NTP On NCNs" class="dd-item ">
        <a href="/docs-csm/en-09/108-ncn-ntp/">
        NTP On NCNs
        
        </a>
    </li>
     
  
 

      
      




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/" title="operations" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/">
          operations
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/boot_orchestration/" title="boot orchestration" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/boot_orchestration/">
          boot orchestration
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/boot_orchestration/stage_changes_without_bos/" title="Stage Changes Without BOS" class="dd-item ">
        <a href="/docs-csm/en-09/operations/boot_orchestration/stage_changes_without_bos/">
        Stage Changes Without BOS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/boot_orchestration/upload_node_boot_information_to_boot_script_service_bss/" title="Upload Node Boot Information to Boot Script Service (BSS)" class="dd-item ">
        <a href="/docs-csm/en-09/operations/boot_orchestration/upload_node_boot_information_to_boot_script_service_bss/">
        Upload Node Boot Information to Boot Script Service (BSS)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/configuration_management/" title="configuration management" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/configuration_management/">
          configuration management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/configuration_management/configuration_layers/" title="Configuration Layers" class="dd-item ">
        <a href="/docs-csm/en-09/operations/configuration_management/configuration_layers/">
        Configuration Layers
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/csm_product_management/" title="CSM product management" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/csm_product_management/">
          CSM product management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/csm_product_management/apply_security_hardening/" title="Security Hardening" class="dd-item ">
        <a href="/docs-csm/en-09/operations/csm_product_management/apply_security_hardening/">
        Security Hardening
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/csm_product_management/change_passwords_and_credentials/" title="Change Passwords and Credentials" class="dd-item ">
        <a href="/docs-csm/en-09/operations/csm_product_management/change_passwords_and_credentials/">
        Change Passwords and Credentials
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/kubernetes/" title="kubernetes" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/kubernetes/">
          kubernetes
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/kubernetes/cert_renewal_for_kubernetes_and_bare_metal_etcd/" title="Kubernetes and Bare Metal EtcD Certificate Renewal" class="dd-item ">
        <a href="/docs-csm/en-09/operations/kubernetes/cert_renewal_for_kubernetes_and_bare_metal_etcd/">
        Kubernetes and Bare Metal EtcD Certificate Renewal
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/network/" title="network" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/network/">
          network
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/network/metallb_bgp/" title="metallb bgp" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/network/metallb_bgp/">
          metallb bgp
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/network/metallb_bgp/check_bgp_status_and_reset_sessions/" title="Check BGP Status and Reset Sessions" class="dd-item ">
        <a href="/docs-csm/en-09/operations/network/metallb_bgp/check_bgp_status_and_reset_sessions/">
        Check BGP Status and Reset Sessions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/system_management_health/" title="system management health" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/system_management_health/">
          system management health
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/system_management_health/troubleshoot_prometheus_alerts/" title="Troubleshoot Prometheus Alerts" class="dd-item ">
        <a href="/docs-csm/en-09/operations/system_management_health/troubleshoot_prometheus_alerts/">
        Troubleshoot Prometheus Alerts
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/fas_loader/" title="FAS Loader" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/fas_loader/">
          FAS Loader
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/fas_loader/fas_loader_fails/" title="TROUBLESHOOTING FAS LOADER FAILS" class="dd-item ">
        <a href="/docs-csm/en-09/operations/fas_loader/fas_loader_fails/">
        TROUBLESHOOTING FAS LOADER FAILS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/hmcollector/" title="hmcollector" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/hmcollector/">
          hmcollector
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/hmcollector/adjust_hmcollector_resource_limits_requests/" title="Adjust HM Collector resource limits and requests" class="dd-item ">
        <a href="/docs-csm/en-09/operations/hmcollector/adjust_hmcollector_resource_limits_requests/">
        Adjust HM Collector resource limits and requests
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/" title="security and authentication" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/security_and_authentication/">
          security and authentication
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/add_ldap_user_federation/" title="Add LDAP User Federation" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/add_ldap_user_federation/">
        Add LDAP User Federation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_air-cooled_node_bmc_credentials/" title="Change Air-Cooled Node BMC Credentials" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_air-cooled_node_bmc_credentials/">
        Change Air-Cooled Node BMC Credentials
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_credentials_on_servertech_pdus/" title="Change Credentials on ServerTech PDUs" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_credentials_on_servertech_pdus/">
        Change Credentials on ServerTech PDUs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_ex_cabinet_global_default_password/" title="Change Cray EX Cabinet Global Default Password" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_ex_cabinet_global_default_password/">
        Change Cray EX Cabinet Global Default Password
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_ncn_image_root_password_and_ssh_keys/" title="Change NCN Image Root Password and SSH Keys" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_ncn_image_root_password_and_ssh_keys/">
        Change NCN Image Root Password and SSH Keys
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_ncn_image_root_password_and_ssh_keys_on_pit_node/" title="Change NCN Image Root Password and SSH Keys on PIT Node" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_ncn_image_root_password_and_ssh_keys_on_pit_node/">
        Change NCN Image Root Password and SSH Keys on PIT Node
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_smnp_credentials_on_leaf_switches/" title="Change SMNP Credentials on Leaf Switches" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_smnp_credentials_on_leaf_switches/">
        Change SMNP Credentials on Leaf Switches
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/change_the_keycloak_admin_password/" title="Change the Keycloak Admin Password" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/change_the_keycloak_admin_password/">
        Change the Keycloak Admin Password
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/provisioning_a_liquid-cooled_ex_cabinet_cec_with_default_credentials/" title="Provisioning a Liquid-Cooled EX Cabinet CEC with Default Credentials" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/provisioning_a_liquid-cooled_ex_cabinet_cec_with_default_credentials/">
        Provisioning a Liquid-Cooled EX Cabinet CEC with Default Credentials
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/restrict_access_to_ncn_images_s3_bucket/" title="Restrict Network Access to the ncn-images S3 Bucket" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/restrict_access_to_ncn_images_s3_bucket/">
        Restrict Network Access to the ncn-images S3 Bucket
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/update_default_air-cooled_bmc_and_leaf_switch_snmp_credentials/" title="Update Default Air-Cooled BMC and Leaf Switch SNMP Credentials" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/update_default_air-cooled_bmc_and_leaf_switch_snmp_credentials/">
        Update Default Air-Cooled BMC and Leaf Switch SNMP Credentials
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/update_default_servertech_pdu_credentials_used_by_the_redfish_translation_service/" title="Update Default ServerTech PDU Credentials used by the Redfish Translation Service (RTS)" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/update_default_servertech_pdu_credentials_used_by_the_redfish_translation_service/">
        Update Default ServerTech PDU Credentials used by the Redfish Translation Service (RTS)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/update_ncn_passwords/" title="Update NCN Passwords" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/update_ncn_passwords/">
        Update NCN Passwords
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/security_and_authentication/updating_the_liquid-cooled_ex_cabinet_default_credentials_after_a_cec_password_change/" title="Updating the Liquid-Cooled EX Cabinet Default Credentials after a CEC Password Change" class="dd-item ">
        <a href="/docs-csm/en-09/operations/security_and_authentication/updating_the_liquid-cooled_ex_cabinet_default_credentials_after_a_cec_password_change/">
        Updating the Liquid-Cooled EX Cabinet Default Credentials after a CEC Password Change
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/operations/node_management/" title="node management" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/operations/node_management/">
          node management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/node_management/adding_a_liquid-cooled_blade_to_a_system/" title="Adding a Liquid-cooled blade to a System" class="dd-item ">
        <a href="/docs-csm/en-09/operations/node_management/adding_a_liquid-cooled_blade_to_a_system/">
        Adding a Liquid-cooled blade to a System
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/node_management/check_and_set_the_metalno-wipe_setting_on_ncns/" title="Check and Set the metal.no-wipe Setting on NCNs" class="dd-item ">
        <a href="/docs-csm/en-09/operations/node_management/check_and_set_the_metalno-wipe_setting_on_ncns/">
        Check and Set the metal.no-wipe Setting on NCNs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/node_management/enable_kdump/" title="Enable Kdump" class="dd-item ">
        <a href="/docs-csm/en-09/operations/node_management/enable_kdump/">
        Enable Kdump
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/node_management/reboot_ncns/" title="Reboot NCNs" class="dd-item ">
        <a href="/docs-csm/en-09/operations/node_management/reboot_ncns/">
        Reboot NCNs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/operations/node_management/removing_a_liquid-cooled_blade_from_a_system/" title="Removing a Liquid-cooled blade from a System" class="dd-item ">
        <a href="/docs-csm/en-09/operations/node_management/removing_a_liquid-cooled_blade_from_a_system/">
        Removing a Liquid-cooled blade from a System
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/055-certificate-authority/" title="Overview" class="dd-item ">
        <a href="/docs-csm/en-09/055-certificate-authority/">
        Overview
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/401-management-network-install/" title="Overview" class="dd-item ">
        <a href="/docs-csm/en-09/401-management-network-install/">
        Overview
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/420-mgmt-net-pxe-tshoot/" title="PXE boot Troubleshooting" class="dd-item ">
        <a href="/docs-csm/en-09/420-mgmt-net-pxe-tshoot/">
        PXE boot Troubleshooting
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/065-csm-safeguards/" title="Safeguards" class="dd-item ">
        <a href="/docs-csm/en-09/065-csm-safeguards/">
        Safeguards
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/300-service-guides/" title="Service Guides" class="dd-item ">
        <a href="/docs-csm/en-09/300-service-guides/">
        Service Guides
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/067-shasta-cfg/" title="Setup Site-Init From SHASTA-CFG" class="dd-item active">
        <a href="/docs-csm/en-09/067-shasta-cfg/">
        Setup Site-Init From SHASTA-CFG
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/305-switch-metadata/" title="Switch Metadata" class="dd-item ">
        <a href="/docs-csm/en-09/305-switch-metadata/">
        Switch Metadata
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/500-uas-uai-admin-and-user-guide/" title="The Shasta User Access Service" class="dd-item ">
        <a href="/docs-csm/en-09/500-uas-uai-admin-and-user-guide/">
        The Shasta User Access Service
        
        </a>
    </li>
     
  
 

      
      




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/" title="upgrade" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/">
          upgrade
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/" title="CSM 0.9 Patch Release Upgrade Procedures" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/">
          CSM 0.9 Patch Release Upgrade Procedures
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.6/" title="CSM 0.9.6 Patch Installation Instructions" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.6/">
          CSM 0.9.6 Patch Installation Instructions
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.4/" title="CSM 0.9.4 Patch Upgrade Guide" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.4/">
          CSM 0.9.4 Patch Upgrade Guide
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/" title="CVE-2021-22555 CVE-2021-33909" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/">
          CVE-2021-22555 CVE-2021-33909
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/" title="operations" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/">
          operations
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/network/" title="network" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/network/">
          network
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/network/metallb_bgp/" title="metallb bgp" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/network/metallb_bgp/">
          metallb bgp
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/network/metallb_bgp/check_bgp_status_and_reset_sessions/" title="Check BGP Status and Reset Sessions" class="dd-item ">
        <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/network/metallb_bgp/check_bgp_status_and_reset_sessions/">
        Check BGP Status and Reset Sessions
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/node_management/" title="node management" class="dd-item
        
        
        
        ">
      <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/node_management/">
          node management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/node_management/check_and_set_the_metalno-wipe_setting_on_ncns/" title="Check and Set the metal.no-wipe Setting on NCNs" class="dd-item ">
        <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/node_management/check_and_set_the_metalno-wipe_setting_on_ncns/">
        Check and Set the metal.no-wipe Setting on NCNs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/node_management/reboot_ncns/" title="Reboot NCNs" class="dd-item ">
        <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.5/operations/node_management/reboot_ncns/">
        Reboot NCNs
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.2/" title="CSM 0.9.2 Patch Upgrade Guide" class="dd-item ">
        <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.2/">
        CSM 0.9.2 Patch Upgrade Guide
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs-csm/en-09/upgrade/0.9/csm-0.9.3/" title="CSM 0.9.3 Patch Upgrade Guide" class="dd-item ">
        <a href="/docs-csm/en-09/upgrade/0.9/csm-0.9.3/">
        CSM 0.9.3 Patch Upgrade Guide
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/069-upgrade-workarounds-rpm/" title="Upgrade CSM Install Workarounds RPM" class="dd-item ">
        <a href="/docs-csm/en-09/069-upgrade-workarounds-rpm/">
        Upgrade CSM Install Workarounds RPM
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/070-usp-install-workarounds/" title="Utility Storage Installation Troubleshooting" class="dd-item ">
        <a href="/docs-csm/en-09/070-usp-install-workarounds/">
        Utility Storage Installation Troubleshooting
        
        </a>
    </li>
     
  
 

      
      




 
  
    
      <li data-nav-id="/docs-csm/en-09/400-switch-bgp-neighbors/" title="Verify and Update BGP neighbors" class="dd-item ">
        <a href="/docs-csm/en-09/400-switch-bgp-neighbors/">
        Verify and Update BGP neighbors
        
        </a>
    </li>
     
  
 

      
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/docs-csm/en-09/'>CRAY System Management - Guides and References</a> > Setup Site-Init From SHASTA-CFG
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#background">Background</a></li>
    <li><a href="#create-and-initialize-site-init-directory">Create and Initialize Site-Init Directory</a></li>
    <li><a href="#create-baseline-system-customizations">Create Baseline System Customizations</a></li>
    <li><a href="#generate-sealed-secrets">Generate Sealed Secrets</a></li>
    <li><a href="#version-control-site-init-files">Version Control Site-Init Files</a>
      <ul>
        <li><a href="#push-to-a-remote-repository">Push to a Remote Repository</a></li>
      </ul>
    </li>
    <li><a href="#customer-specific-customizations">Customer-Specific Customizations</a></li>
    <li><a href="#appendix">Appendix</a></li>
    <li><a href="#tracked-sealed-secrets">Tracked Sealed Secrets</a></li>
    <li><a href="#decrypting-sealed-secrets-for-review">Decrypting Sealed Secrets for Review</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
            </h1>
          

        


<h1 id="setup-site-init-from-shasta-cfg">Setup Site-Init From SHASTA-CFG</h1>
<p>These procedures guide administrators through setting up the <code>site-init</code>
directory which contains important customizations for various products. The
<a href="/docs-csm/en-09/#appendix">appendix</a> is informational only; it does <strong>not</strong> include any
default install procedures.</p>
<ul>
<li><a href="/docs-csm/en-09/#background">Background</a></li>
<li><a href="/docs-csm/en-09/#create-and-initialize-site-init-directory">Create and Initialize Site-Init Directory</a></li>
<li><a href="/docs-csm/en-09/#create-baseline-system-customizations">Create Baseline System Customizations</a></li>
<li><a href="/docs-csm/en-09/#generate-sealed-secrets">Generate Sealed Secrets</a></li>
<li><a href="/docs-csm/en-09/#version-control-site-init-files">Version Control Site-Init Files</a>
<ul>
<li><a href="/docs-csm/en-09/#push-to-a-remote-repository">Push to a Remote Repository</a></li>
</ul>
</li>
<li><a href="/docs-csm/en-09/#customer-specific-customizations">Customer-Specific Customizations</a></li>
<li><a href="/docs-csm/en-09/#appendix">Appendix</a>
<ul>
<li><a href="/docs-csm/en-09/#tracked-sealed-secrets">Tracked Sealed Secrets</a></li>
<li><a href="/docs-csm/en-09/#decrypting-sealed-secrets-for-review">Decrypting Sealed Secrets for Review</a></li>
</ul>
</li>
</ul>
<h2 id="background">Background</h2>
<p>The <code>shasta-cfg</code> directory included in CSM includes relatively static,
installation-centric artifacts such as:</p>
<ul>
<li>Cluster-wide network configuration settings required by Helm Charts
deployed by product stream Loftsman Manifests</li>
<li><a href="https://github.com/bitnami-labs/sealed-secrets">Sealed Secrets</a></li>
<li>Sealed Secret Generate Blocks &ndash; an form of plain-text input that renders
to a Sealed Secret</li>
<li>Helm Chart value overrides that are merged into Loftsman Manifests by
product stream installers</li>
</ul>
<h2 id="create-and-initialize-site-init-directory">Create and Initialize Site-Init Directory</h2>
<ol>
<li>
<p>Create directory <code>/mnt/pitdata/prep/site-init</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# mkdir -p /mnt/pitdata/prep/site-init
</span></span><span style="display:flex;"><span>linux# cd /mnt/pitdata/prep/site-init
</span></span></code></pre></div></li>
<li>
<p>Initialize <code>/mnt/pitdata/prep/site-init</code> from CSM:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/shasta-cfg/meta/init.sh /mnt/pitdata/prep/site-init
</span></span></code></pre></div></li>
<li>
<p>The <code>yq</code> tool used in the following procedures is available under
<code>/mnt/pitdata/prep/site-init/utils/bin</code> once the SHASTA-CFG repo has been
cloned</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# alias yq<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/mnt/pitdata/</span><span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span><span style="color:#e6db74">/shasta-cfg/utils/bin/</span><span style="color:#66d9ef">$(</span>uname | awk <span style="color:#e6db74">&#39;{print tolower($0)}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">/yq&#34;</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="create-baseline-system-customizations">Create Baseline System Customizations</h2>
<p>The following steps update <code>/mnt/pitdata/prep/site-init/customizations.yaml</code>
with system-specific customizations.</p>
<ol>
<li>
<p>Ensure system-specific settings generated by CSI are merged into
<code>customizations.yaml</code>:</p>
<blockquote>
<p>Note the system name environment variable <code>SYSTEM_NAME</code> must be set</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq merge -xP -i /mnt/pitdata/prep/site-init/customizations.yaml &lt;<span style="color:#f92672">(</span>yq prefix -P <span style="color:#e6db74">&#34;/mnt/pitdata/prep/</span><span style="color:#e6db74">${</span>SYSTEM_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">/customizations.yaml&#34;</span> spec<span style="color:#f92672">)</span>
</span></span></code></pre></div></li>
<li>
<p>Set the cluster name:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -i /mnt/pitdata/prep/site-init/customizations.yaml spec.wlm.cluster_name <span style="color:#e6db74">&#34;</span>$SYSTEM_NAME<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Make a backup copy of <code>/mnt/pitdata/prep/site-init/customizations.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# cp /mnt/pitdata/prep/site-init/customizations.yaml /mnt/pitdata/prep/site-init/customizations.yaml.prepassword
</span></span></code></pre></div></li>
<li>
<p>Review the configuration to generate these sealed secrets in <code>customizations.yaml</code> in the <code>site-init</code> directory:</p>
<ul>
<li><code>spec.kubernetes.sealed_secrets.cray_reds_credentials</code></li>
<li><code>spec.kubernetes.sealed_secrets.cray_meds_credentials</code></li>
<li><code>spec.kubernetes.sealed_secrets.cray_hms_rts_credentials</code></li>
</ul>
<p>Edit <code>customizations.yaml</code>, replacing the <code>Password</code> references with values appropriate for your system. See
<a href="/docs-csm/en-09/#decrypting-sealed-secrets-for-review">Decrypting Sealed Secrets for Review</a> if you need to examine
credentials from prior installs.</p>
</li>
<li>
<p>Review the changes that you made:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# diff /mnt/pitdata/prep/site-init/customizations.yaml /mnt/pitdata/prep/site-init/customizations.yaml.prepassword
</span></span></code></pre></div></li>
<li>
<p>Validate that REDS/MEDS/RTS sealed secrets contain valid JSON using <code>jq</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Validate REDS credentials (used by the REDS and HMS discovery services,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># targeting River Redfish BMC endpoints and management switches)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.cray_reds_credentials.generate.data[0].args.value&#39;</span> | jq
</span></span><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.cray_reds_credentials.generate.data[1].args.value&#39;</span> | jq
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># NOTE: For vault_redfish_defaults, the only entry used is &#39;{&#34;Cray&#34;: {&#34;Username&#34;: &#34;root&#34;, &#34;Password&#34;: &#34;XXXX&#34;}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Make sure it is specified as shown, with the &#39;Cray&#39; key. This key is not</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># used in any of the other credential specifications. Make sure Username and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Password entries are correct.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Validate MEDS credentials (used by the MEDS service, targeting</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Redfish BMC endpoints). Make sure Username and Password entries are correct.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.cray_meds_credentials.generate.data[0].args.value&#39;</span> | jq
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Validate RTS credentials (used by the Redfish Translation Service, targeting</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># River Redfish BMC endpoints and PDU controllers). Make sure Username and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Password entries are correct.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.cray_hms_rts_credentials.generate.data[0].args.value&#39;</span> | jq
</span></span><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.cray_hms_rts_credentials.generate.data[1].args.value&#39;</span> | jq
</span></span></code></pre></div></li>
<li>
<p>To customize the PKI Certificate Authority (CA) used by the platform, see
<a href="/docs-csm/en-09/055-certificate-authority/">Customizing the Platform CA</a>.</p>
<blockquote>
<p><strong><code>IMPORTANT</code></strong> The CA may not be modified after install.</p>
</blockquote>
</li>
<li>
<p>To federate Keycloak with an upstream LDAP:</p>
<blockquote>
<p><strong><code>INTERNAL ONLY</code></strong> On internal HPE systems, if the IP address for
the ncn-m001 node is even then use <code>ldaps://dcldap2.hpc.amslabs.hpecorp.net</code>,
otherwise use <code>ldaps://dcldap3.us.cray.com</code>. For example, <code>ping fanta-ncn-m001.us.cray.com</code> shows the IP address is <code>172.30.52.72</code>,
so fanta would use <code>ldaps://dcldap2.hpc.amslabs.hpecorp.net</code> as the
<code>ldap_connection_url</code>. This just spreads the load over the two LDAP
replicas.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# export LDAP<span style="color:#f92672">=</span>dcldap2.hpc.amslabs.hpecorp.net
</span></span></code></pre></div></blockquote>
<ul>
<li>
<p>If LDAP requires TLS (recommended), update the <code>cray-keycloak</code> sealed
secret value by supplying a base64 encoded Java KeyStore (JKS) that
contains the CA certificate that signed the LDAP server&rsquo;s host key. The
password for the JKS file must be <code>password</code>. Admins may use the
<code>keytool</code> command from the <code>openjdk:11-jre-slim</code> container image
packaged with CSM to create a JKS file that includes a PEM-encoded
CA certificate to verify the LDAP host(s) as follows:</p>
<p>Load the <code>openjdk</code> container image:</p>
<blockquote>
<p><strong><code>NOTE</code></strong> Requires a properly configured Docker or Podman
environment.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/hack/load-container-image.sh dtr.dev.cray.com/library/openjdk:11-jre-slim
</span></span></code></pre></div><p>Create (or update) <code>cert.jks</code> with the PEM-encoded CA certificate for an
LDAP host:</p>
<blockquote>
<p><strong><code>IMPORTANT</code></strong> Replace <code>&lt;ca-cert.pem&gt;</code> and <code>&lt;alias&gt;</code> as appropriate.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# podman run --rm -v <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">:/data&#34;</span> dtr.dev.cray.com/library/openjdk:11-jre-slim keytool <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>              -importcert -trustcacerts -file /data/&lt;ca-cert.pem&gt; -alias &lt;alias&gt; <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>              -keystore /data/certs.jks -storepass password -noprompt
</span></span></code></pre></div><blockquote>
<p><strong><code>INTERNAL ONLY</code></strong> For example, on internal HPE systems, create the
<code>certs.jks.b64</code> file as follows:</p>
<ul>
<li>
<p>Get the issuer certificate for dcldap. Use <code>openssl s_client</code> to connect
and show the certificate chain returned by the LDAP host:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# openssl s_client -showcerts -connect $LDAP:636 &lt;/dev/null
</span></span></code></pre></div><p>Either manually extract (i.e., cut/paste) the issuer&rsquo;s
certificate into <code>cacert.pem</code> or try the following commands to
create it automatically.</p>
<blockquote>
<p><strong><code>NOTE</code></strong> The following commands were verified using OpenSSL
version 1.1.1d and use the <code>-nameopt RFC2253</code> option to ensure
consistent formatting of distinguished names (DNs).
Unfortunately, older versions of OpenSSL may not support
<code>-nameopt</code> on the <code>s_client</code> command or may use a different
default format. As a result, your mileage may vary; however,
you should be able to manually extract the issuer certificate
from the output of the above <code>openssl s_client</code> example if the
following commands are unsuccessful.</p>
</blockquote>
<ol>
<li>
<p>Observe the issuer&rsquo;s DN:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# openssl s_client -showcerts -nameopt RFC2253 -connect $LDAP:636 &lt;/dev/null 2&gt;/dev/null | grep issuer<span style="color:#f92672">=</span> | sed -e <span style="color:#e6db74">&#39;s/^issuer=//&#39;</span>
</span></span></code></pre></div><p>Expected output looks like:</p>
<pre tabindex="0"><code>emailAddress=dcops@hpe.com,CN=Data Center,OU=HPC/MCS,O=HPE,ST=WI,C=US
</code></pre></li>
<li>
<p>Extract the issuer&rsquo;s certificate using <code>awk</code>:</p>
<blockquote>
<p><strong><code>NOTE</code></strong> The issuer DN is properly escaped as part of the
<code>awk</code> pattern below. If the value you are using is
different, be sure to escape it properly!</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# openssl s_client -showcerts -nameopt RFC2253 -connect $LDAP:636 &lt;/dev/null 2&gt;/dev/null |
</span></span><span style="display:flex;"><span>          awk <span style="color:#e6db74">&#39;/s:emailAddress=dcops@hpe.com,CN=Data Center,OU=HPC\/MCS,O=HPE,ST=WI,C=US/,/END CERTIFICATE/&#39;</span> |
</span></span><span style="display:flex;"><span>          awk <span style="color:#e6db74">&#39;/BEGIN CERTIFICATE/,/END CERTIFICATE/&#39;</span> &gt; cacert.pem
</span></span></code></pre></div></li>
</ol>
</li>
<li>
<p>Verify issuer&rsquo;s certificate was properly extracted and saved in <code>cacert.pem</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# cat cacert.pem
</span></span></code></pre></div><p>Expected output looks like:</p>
<pre tabindex="0"><code>-----BEGIN CERTIFICATE-----
MIIDvTCCAqWgAwIBAgIUYxrG/PrMcmIzDuJ+U1Gh8hpsU8cwDQYJKoZIhvcNAQEL
BQAwbjELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAldJMQwwCgYDVQQKDANIUEUxEDAO
BgNVBAsMB0hQQy9NQ1MxFDASBgNVBAMMC0RhdGEgQ2VudGVyMRwwGgYJKoZIhvcN
AQkBFg1kY29wc0BocGUuY29tMB4XDTIwMTEyNDIwMzM0MVoXDTMwMTEyMjIwMzM0
MVowbjELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAldJMQwwCgYDVQQKDANIUEUxEDAO
BgNVBAsMB0hQQy9NQ1MxFDASBgNVBAMMC0RhdGEgQ2VudGVyMRwwGgYJKoZIhvcN
AQkBFg1kY29wc0BocGUuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
AQEAuBIZkKitHHVQHymtaQt4D8ZhG4qNJ0cTsLhODPMtVtBjPZp59e+PWzbc9Rj5
+wfjLGteK6/fNJsJctWlS/ar4jw/xBIPMk5pg0dnkMT2s7lkSCmyd9Uib7u6y6E8
yeGoGcb7I+4ZI+E3FQV7zPact6b17xmajNyKrzhBGEjYucYJUL5iTgZ6a7HOZU2O
aQSXe7ctiHBxe7p7RhHCuKRrqJnxoohakloKwgHHzDLFQzX/5ADp1hdJcduWpaXY
RMBu6b1mhmwo5vmc+fDnfUpl5/X4i109r9VN7JC7DQ5+JX8u9SHDGLggBWkrhpvl
bNXMVCnwnSFfb/rnmGO7rdJSpwIDAQABo1MwUTAdBgNVHQ4EFgQUVg3VYExUAdn2
WE3e8Xc8HONy/+4wHwYDVR0jBBgwFoAUVg3VYExUAdn2WE3e8Xc8HONy/+4wDwYD
VR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAWLDQLB6rrmK+gwUY+4B7
0USbQK0JkLWuc0tCfjTxNQTzFb75PeH+GH21QsjUI8VC6QOAAJ4uzIEV85VpOQPp
qjz+LI/Ej1xXfz5ostZQu9rCMnPtVu7JT0B+NV7HvgqidTfa2M2dw9yUYS2surZO
8S0Dq3Bi6IEhtGU3T8ZpbAmAp+nNsaJWdUNjD4ECO5rAkyA/Vu+WyMz6F3ZDBmRr
ipWM1B16vx8rSpQpygY+FNX4e1RqslKhoyuzXfUGzyXux5yhs/ufOaqORCw3rJIx
v4sTWGsSBLXDsFM3lBgljSAHfmDuKdO+Qv7EqGzCRMpgSciZihnbQoRrPZkOHUxr
NA==
-----END CERTIFICATE-----
</code></pre></li>
<li>
<p>Create <code>certs.jks</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# podman run --rm -v <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">:/data&#34;</span> dtr.dev.cray.com/library/openjdk:11-jre-slim keytool -importcert <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>              -trustcacerts -file /data/cacert.pem -alias cray-data-center-ca -keystore /data/certs.jks <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>              -storepass password -noprompt
</span></span></code></pre></div></li>
</ul>
</blockquote>
<p>Create <code>certs.jks.b64</code> by base-64 encoding <code>certs.jks</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# base64 certs.jks &gt; certs.jks.b64
</span></span></code></pre></div><p>Then, inject and encrypt <code>certs.jks.b64</code> into <code>customizations.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# cat <span style="color:#e6db74">&lt;&lt;EOF | yq w - &#39;data.&#34;certs.jks&#34;&#39; &#34;$(&lt;certs.jks.b64)&#34; | \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    yq r -j - | /mnt/pitdata/prep/site-init/utils/secrets-encrypt.sh | \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    yq w -f - -i /mnt/pitdata/prep/site-init/customizations.yaml &#39;spec.kubernetes.sealed_secrets.cray-keycloak&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;kind&#34;: &#34;Secret&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;apiVersion&#34;: &#34;v1&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;metadata&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;name&#34;: &#34;keycloak-certs&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;namespace&#34;: &#34;services&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;creationTimestamp&#34;: null
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;data&#34;: {}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div></li>
<li>
<p>Update the <code>keycloak_users_localize</code> sealed secret with the
appropriate value for <code>ldap_connection_url</code>.</p>
<p>Set <code>ldap_connection_url</code> in <code>customizations.yaml</code>:</p>
<blockquote>
<p><strong><code>IMPORTANT</code></strong> Replace <code>&lt;ldap-url&gt;</code> as appropriate.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -i /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>        <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.keycloak_users_localize.generate.data.(args.name==ldap_connection_url).args.value&#39;</span> <span style="color:#e6db74">&#39;&lt;ldap-url&gt;&#39;</span>
</span></span></code></pre></div><blockquote>
<p><strong><code>INTERNAL ONLY</code></strong></p>
<p>Set <code>ldap_connection_url</code> in <code>customizations.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -i /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>        <span style="color:#e6db74">&#39;spec.kubernetes.sealed_secrets.keycloak_users_localize.generate.data.(args.name==ldap_connection_url).args.value&#39;</span> <span style="color:#e6db74">&#34;ldaps://</span>$LDAP<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>On success, review the <code>keycloak_users_localize</code> sealed secret:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml spec.kubernetes.sealed_secrets.keycloak_users_localize
</span></span></code></pre></div><p>Expected output is similar to:</p>
<pre tabindex="0"><code>generate:
    name: keycloak-users-localize
    data:
    - type: static
        args:
        name: ldap_connection_url
        value: ldaps://dcldap2.hpc.amslabs.hpecorp.net
</code></pre></blockquote>
</li>
<li>
<p>Configure the <code>ldapSearchBase</code> and <code>localRoleAssignments</code> settings for
the <code>cray-keycloak-users-localize</code> chart in <code>customizations.yaml</code>.</p>
<p>Set <code>ldapSearchBase</code> in <code>customizations.yaml</code>:</p>
<blockquote>
<p><strong><code>IMPORTANT</code></strong> Replace <code>&lt;search-base&gt;</code> as appropriate.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -i /mnt/pitdata/prep/site-init/customizations.yaml spec.kubernetes.services.cray-keycloak-users-localize.ldapSearchBase <span style="color:#e6db74">&#39;&lt;search-base&gt;&#39;</span>
</span></span></code></pre></div><p>Set <code>localRoleAssignments</code> that map to <code>admin</code> and/or <code>user</code> roles for
both <code>shasta</code> and <code>cray</code> clients in <code>customizations.yaml</code>:</p>
<blockquote>
<p><strong><code>IMPORTANT</code></strong> Replace <code>&lt;admin-group&gt;</code> and <code>&lt;user-group&gt;</code> as
appropriate. Also add other assignments as desired.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -s - -i /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">- command: update
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  path: spec.kubernetes.services.cray-keycloak-users-localize.localRoleAssignments
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  value:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;&lt;admin-group&gt;&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;&lt;admin-group&gt;&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;&lt;user-group&gt;&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: &#34;shasta&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;&lt;user-group&gt;&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: &#34;cray&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><blockquote>
<p><strong><code>INTERNAL ONLY</code></strong> For example, on internal HPE systems appropriate
settings are:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">ldapSearchBase</span>: <span style="color:#e6db74">&#34;dc=dcldap,dc=dit&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">localRoleAssignments</span>:
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;criemp&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;shasta&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;criemp&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;cray&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;craydev&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;shasta&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;craydev&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;cray&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;shasta_admins&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;shasta&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;shasta_admins&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;cray&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;shasta_users&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;shasta&#34;</span>}
</span></span><span style="display:flex;"><span>    - {<span style="color:#f92672">&#34;group&#34;: &#34;shasta_users&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: </span><span style="color:#e6db74">&#34;cray&#34;</span>}
</span></span></code></pre></div><p>Set <code>ldapSearchBase</code> in <code>customizations.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -i /mnt/pitdata/prep/site-init/customizations.yaml spec.kubernetes.services.cray-keycloak-users-localize.ldapSearchBase <span style="color:#e6db74">&#39;dc=dcldap,dc=dit&#39;</span>
</span></span></code></pre></div><p>Set <code>localRoleAssignments</code> in <code>customizations.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -s - -i /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">- command: update
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  path: spec.kubernetes.services.cray-keycloak-users-localize.localRoleAssignments
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  value:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;criemp&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;criemp&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;craydev&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;craydev&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;shasta_admins&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;shasta_admins&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;shasta_users&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: &#34;shasta&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  - {&#34;group&#34;: &#34;shasta_users&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: &#34;cray&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><p>On success, review the <code>cray-keycloak-users-localize</code> values:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml spec.kubernetes.services.cray-keycloak-users-localize
</span></span></code></pre></div><p>Expected output looks similar to:</p>
<pre tabindex="0"><code>sealedSecrets:
    - &#39;{{ kubernetes.sealed_secrets.keycloak_users_localize | toYaml }}&#39;
localRoleAssignments:
    - {&#34;group&#34;: &#34;criemp&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
    - {&#34;group&#34;: &#34;criemp&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
    - {&#34;group&#34;: &#34;craydev&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
    - {&#34;group&#34;: &#34;craydev&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
    - {&#34;group&#34;: &#34;shasta_admins&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;shasta&#34;}
    - {&#34;group&#34;: &#34;shasta_admins&#34;, &#34;role&#34;: &#34;admin&#34;, &#34;client&#34;: &#34;cray&#34;}
    - {&#34;group&#34;: &#34;shasta_users&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: &#34;shasta&#34;}
    - {&#34;group&#34;: &#34;shasta_users&#34;, &#34;role&#34;: &#34;user&#34;, &#34;client&#34;: &#34;cray&#34;}
ldapSearchBase: dc=dcldap,dc=dit
</code></pre></blockquote>
</li>
</ul>
</li>
<li>
<p>If you need to resolve outside hostnames, you will need to configure
forwarding in the cray-dns-unbound service. For example, if you are using a
hostname and not an IP for the upstream LDAP server in step 4 above, you
will need to be able to resolve that hostname.</p>
<p>Set the <code>localZones</code> and <code>forwardZones</code> for the <code>cray-dns-unbound</code> service:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq write -s - -i /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">- command: update
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  path: spec.kubernetes.services.cray-dns-unbound
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  value:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    localZones:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    - localType: static
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      name: &#34;local&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    forwardZones:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    - name: &#34;.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      forwardIps:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      - &#34;{{ network.netstaticips.system_to_site_lookups }}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><p>On success, review the <code>cray-dns-unbound</code> values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq read /mnt/pitdata/prep/site-init/customizations.yaml spec.kubernetes.services.cray-dns-unbound
</span></span></code></pre></div><p>Expected output looks similar to:</p>
<pre tabindex="0"><code>localZones:
- localType: static
  name: &#34;local&#34;
forwardZones:
- name: &#34;.&#34;
  forwardIps:
  - &#34;{{ network.netstaticips.system_to_site_lookups }}&#34;
</code></pre></li>
<li>
<p>Review <code>customizations.yaml</code> in the <code>site-init</code> directory and replace remaining <code>~FIXME~</code> values with
appropriate settings.</p>
<ol>
<li>
<p>Create backup copy of <code>customizations.yaml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# cp /mnt/pitdata/prep/site-init/customizations.yaml /mnt/pitdata/prep/site-init/customizations.yaml-prefixme
</span></span></code></pre></div></li>
<li>
<p>Edit <code>customizations.yaml</code>
For the following <code>~FIXME~</code> values, use the example provided and just remove the <code>~FIXME~ e.g.</code></p>
<pre tabindex="0"><code>   sma-rsyslog-aggregator:
     cray-service:
       service:
         loadBalancerIP: ~FIXME~ e.g. 10.92.100.72
     rsyslogAggregatorHmn:
       service:
         loadBalancerIP: ~FIXME~ e.g. 10.94.100.2

   sma-rsyslog-aggregator-udp:
     cray-service:
       service:
         loadBalancerIP: ~FIXME~ e.g. 10.92.100.75
     rsyslogAggregatorUdpHmn:
       service:
         loadBalancerIP: ~FIXME~ e.g. 10.94.100.3
</code></pre></li>
<li>
<p>Review your changes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# diff /mnt/pitdata/prep/site-init/customizations.yaml /mnt/pitdata/prep/site-init/customizations.yaml-prefixme
</span></span></code></pre></div></li>
</ol>
</li>
</ol>
<h2 id="generate-sealed-secrets">Generate Sealed Secrets</h2>
<p>Secrets are stored in <code>customizations.yaml</code> as <code>SealedSecret</code> resources (i.e.,
encrypted secrets) which are deployed by specific charts and decrypted by the
Sealed Secrets operator. But first, those secrets must be seeded generated and
encrypted.</p>
<ol>
<li>
<p>Load the <code>zeromq</code> container image required by Sealed Secret Generators:</p>
<blockquote>
<p><strong><code>NOTE</code></strong> Requires a properly configured Docker or Podman environment.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/hack/load-container-image.sh dtr.dev.cray.com/zeromq/zeromq:v4.0.5
</span></span></code></pre></div></li>
<li>
<p>Re-encrypt existing secrets:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# /mnt/pitdata/prep/site-init/utils/secrets-reencrypt.sh /mnt/pitdata/prep/site-init/customizations.yaml <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            /mnt/pitdata/prep/site-init/certs/sealed_secrets.key /mnt/pitdata/prep/site-init/certs/sealed_secrets.crt
</span></span></code></pre></div></li>
<li>
<p>Generate secrets:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# /mnt/pitdata/prep/site-init/utils/secrets-seed-customizations.sh /mnt/pitdata/prep/site-init/customizations.yaml
</span></span></code></pre></div><p>Expected output looks similar to:</p>
<pre tabindex="0"><code>Creating Sealed Secret keycloak-certs
Generating type static_b64...
Creating Sealed Secret keycloak-master-admin-auth
Generating type static...
Generating type static...
Generating type randstr...
Generating type static...
Creating Sealed Secret cray_reds_credentials
Generating type static...
Generating type static...
Creating Sealed Secret cray_meds_credentials
Generating type static...
Creating Sealed Secret cray_hms_rts_credentials
Generating type static...
Generating type static...
Creating Sealed Secret vcs-user-credentials
Generating type randstr...
Generating type static...
Creating Sealed Secret generated-platform-ca-1
Generating type platform_ca...
Creating Sealed Secret pals-config
Generating type zmq_curve...
Generating type zmq_curve...
Creating Sealed Secret munge-secret
Generating type randstr...
Creating Sealed Secret slurmdb-secret
Generating type static...
Generating type static...
Generating type randstr...
Generating type randstr...
Creating Sealed Secret keycloak-users-localize
Generating type static...
</code></pre></li>
</ol>
<h2 id="version-control-site-init-files">Version Control Site-Init Files</h2>
<p>Setup <code>/mnt/pitdata/prep/site-init</code> as a Git repository in order to manage the
baseline configuration during initial system installation.</p>
<ol>
<li>
<p>Initialize <code>/mnt/pitdata/prep/site-info</code> as a Git repository:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# cd /mnt/pitdata/prep/site-init
</span></span><span style="display:flex;"><span>linux# git init .
</span></span></code></pre></div></li>
<li>
<p>(Optional) <strong><code>WARNING</code></strong> If production system or operational security is a
concern, do NOT store the sealed secret private key in Git; instead,
<strong>store the sealed secret key outside of Git in a secure offline system</strong>.
To ensure these sensitive keys are not accidentally committed, configure
<code>.gitignore</code> to ignore files under the <code>certs</code> directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# echo <span style="color:#e6db74">&#34;certs/&#34;</span> &gt;&gt; .gitignore
</span></span></code></pre></div></li>
<li>
<p>Stage site-init files to be committed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# git add -A
</span></span></code></pre></div></li>
<li>
<p>Review what will be committed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# git status
</span></span></code></pre></div></li>
<li>
<p>Commit all the above changes as the baseline configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# git commit -m <span style="color:#e6db74">&#34;Baseline configuration for </span><span style="color:#66d9ef">$(</span>/mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/lib/version.sh<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="push-to-a-remote-repository">Push to a Remote Repository</h3>
<p>It is <strong>strongly recommended</strong> to that the site-init repository be maintained
off-cluster. Add a remote repository and push the baseline configuration on
<code>master</code> branch to a corresponding remote branch.</p>
<h2 id="customer-specific-customizations">Customer-Specific Customizations</h2>
<p>Customer-specific customizations are any changes on top of the baseline
configuration to satisfy customer-specific requirements. It is recommended that
customer-specific customizations be tracked on branches separate from the
mainline in order to make them easier to manage.</p>
<p>Apply any customer-specific customizations by merging the corresponding
branches into <code>master</code> branch of <code>/mnt/pitdata/prep/site-init</code>.</p>
<p>When considering merges, and especially when resolving conflicts, carefully
examine differences to ensure all changes are relevant. For example, when
applying a customer-specific customization used in a prior version, be sure the
change still makes sense. It is common for options to change as new features are
introduced and bugs are fixed.</p>
<hr>
<h2 id="appendix">Appendix</h2>
<h2 id="tracked-sealed-secrets">Tracked Sealed Secrets</h2>
<p>Tracked sealed secrets are regenerated every time secrets are seeded (see the
use of <code>utils/secrets-seed-customizations.sh</code> above). View currently tracked
sealed secrets via:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq read /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/shasta-cfg/customizations.yaml spec.kubernetes.tracked_sealed_secrets
</span></span></code></pre></div><p>Expected output looks similar to:</p>
<pre tabindex="0"><code>- cray_reds_credentials
- cray_meds_credentials
- cray_hms_rts_credentials
</code></pre><p>In order to prevent tracked sealed secrets from being regenerated, they <strong>MUST
BE REMOVED</strong> from the <code>spec.kubernetes.tracked_sealed_secrets</code> list in
<code>/mnt/pitdata/${CSM_RELEASE}/shasta-cfg/customizations.yaml</code> prior to <a href="/docs-csm/en-09/#generate-sealed-secrets">seeding</a>.
To retain the REDS/MEDS/RTS credentials, run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux# yq delete -i /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/shasta-cfg/customizations.yaml spec.kubernetes.tracked_sealed_secrets.cray_reds_credentials
</span></span><span style="display:flex;"><span>linux# yq delete -i /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/shasta-cfg/customizations.yaml spec.kubernetes.tracked_sealed_secrets.cray_meds_credentials
</span></span><span style="display:flex;"><span>linux# yq delete -i /mnt/pitdata/<span style="color:#e6db74">${</span>CSM_RELEASE<span style="color:#e6db74">}</span>/shasta-cfg/customizations.yaml spec.kubernetes.tracked_sealed_secrets.cray_hms_rts_credentials
</span></span></code></pre></div><h2 id="decrypting-sealed-secrets-for-review">Decrypting Sealed Secrets for Review</h2>
<p>For administrators that would like to decrypt and review previously encrypted
sealed secrets, you can use the <code>secrets-decrypt.sh</code> utility in SHASTA-CFG.</p>
<p>Syntax: <code>secret-decrypt.sh SEALED-SECRET-NAME SEALED-SECRET-PRIVATE-KEY CUSTOMIZATIONS-YAML</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>linux:/mnt/pitdata/prep/site-init# ./utils/secrets-decrypt.sh cray_meds_credentials ./certs/sealed_secrets.key ./customizations.yaml | jq .data.vault_redfish_defaults | sed -e <span style="color:#e6db74">&#39;s/&#34;//g&#39;</span> | base64 -d; echo
</span></span></code></pre></div><p>Expected output looks similar to:</p>
<pre tabindex="0"><code>{&#34;Username&#34;: &#34;root&#34;, &#34;Password&#34;: &#34;...&#34;}
</code></pre>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/docs-csm/js/clipboard.min.js?1729741357"></script>
    <script src="/docs-csm/js/perfect-scrollbar.min.js?1729741357"></script>
    <script src="/docs-csm/js/perfect-scrollbar.jquery.min.js?1729741357"></script>
    <script src="/docs-csm/js/jquery.sticky.js?1729741357"></script>
    <script src="/docs-csm/js/featherlight.min.js?1729741357"></script>
    <script src="/docs-csm/js/highlight.pack.js?1729741357"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/docs-csm/js/modernizr.custom-3.6.0.js?1729741357"></script>
    <script src="/docs-csm/js/learn.js?1729741357"></script>
    <script src="/docs-csm/js/hugo-learn.js?1729741357"></script>
    
        
            <script src="/docs-csm/mermaid/mermaid.js?1729741357"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

